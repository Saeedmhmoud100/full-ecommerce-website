{% extends "base.html" %}



{% block title %} Profile {% endblock title %}
{% block content %}
    <div class="container">
      
        
      <div class="row">
        {% if messages %}
          {% for message in messages %}
          <div class="alert alert-{{message.tags}} text-center">{{message}}</div>
          {% endfor %}
        {% endif %}
        <div class="col-md-4 col-md-offset-2" style="border: 1px solid #777;">
          
          <h1 style="border-bottom: 1px solid #777;display: inline-block;margin-bottom: 10px;" > Profile </h1>
          <div class="text-left">
            <p>Username: {{user}}</p>
            <p>Email: {{user.email}}</p>
            <p>Phone: {{ profile.CustPhone }}</p>
          </div>
          <div class="">
            <h3>Add Location</h3>
            <form method="POST">
              {% csrf_token %}
              {% for fm in locform %}
              {% if forloop.first %}
              Country
              {{fm}}
              {{fm.errors}}
              {% else %}
                <div class="">
                  {{fm.label}}
                {{fm}}{{fm.errors}}
                </div>
                {% endif %}
              {% endfor %}
              <button id="add-location" type="submit" class="btn btn-primary" style="margin:10px;">add Location</button>
            </form>
            </div>
        </div>
        <div class=" col-md-offset-1 col-md-4">
          {% if locations %}
            {% for location in locations %}
              <div class="par" style="border: 1px solid #777777;padding-left: 18px;margin-bottom: 10px;overflow: hidden;">
                <h3 style="border-bottom: 1px solid #777;display: inline-block;">Location: {{forloop.counter}}</h3>
                {% if location.CustCountry.name %}
                <p>countryt: {{location.CustCountry.name}},</p>
                {% else %}
                <p>countryt: {{location.CustCountry}},</p>
                {% endif %}
                <p>city: {{location.CustCity}},</p>
                <p>Locality: {{location.CustLocality}},</p>
                <p>Zipcode: {{location.CustZipcode}},</p>
                <a class='remove-location' style="float: right;margin: 10px;" class="btn btn-secondary"><button id="{{location.id}}">Remove</button></a>
              </div>
            {% endfor %}
          {% else %}
            <h2 class="text-center">You dont add any location yet</h2>
          {% endif %}
        </div>
      </div>
    </div>

      
{% endblock content %}


{% block script %}
<script>

  $(function(){
    $('.remove-location').on('click',function(e){
      var id = e.currentTarget.children[0].id
      var elm = this.parentNode
      console.log(elm)
      $.ajax({
        dataType:'json',
        data:{
          'id':id
        },
        url:"/account/profile/delete/"+ id +"/",
        success:function(e){
          elm.remove()
        }
      })
    })
  });

</script>
{% endblock script %}
  